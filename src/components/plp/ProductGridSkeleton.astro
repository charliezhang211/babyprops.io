---
// ğŸ“ src/components/plp/ProductGridSkeleton.astro
// äº§å“ç½‘æ ¼éª¨æ¶å± - ç”¨äº Loading çŠ¶æ€

interface Props {
  count?: number;
  columns?: '2' | '3' | '4';
  class?: string;
}

const {
  count = 8,
  columns = '4',
  class: className = '',
} = Astro.props;

// å“åº”å¼ç½‘æ ¼ç±»
const gridColumns = {
  '2': 'grid-cols-1 sm:grid-cols-2',
  '3': 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3',
  '4': 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4',
};

const gridClass = gridColumns[columns];
---

<div
  class:list={['grid gap-6', gridClass, className]}
  data-component="product-grid-skeleton"
  role="status"
  aria-label="Loading products..."
>
  {Array.from({ length: count }).map(() => (
    <div class="product-card-skeleton animate-pulse">
      {/* å›¾ç‰‡éª¨æ¶ */}
      <div class="aspect-square bg-gray-200 rounded-lg mb-3 relative overflow-hidden">
        {/* é—ªå…‰æ•ˆæœ */}
        <div class="shimmer absolute inset-0"></div>
      </div>

      {/* å¡ç‰‡å†…å®¹åŒºåŸŸ */}
      <div class="p-1">
        {/* æ ‡é¢˜éª¨æ¶ (2è¡Œ) */}
        <div class="space-y-2 mb-3">
          <div class="h-4 bg-gray-200 rounded w-3/4 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
          <div class="h-4 bg-gray-200 rounded w-1/2 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
        </div>

        {/* æ ‡ç­¾éª¨æ¶ */}
        <div class="flex gap-2 mb-3">
          <div class="h-5 bg-gray-200 rounded w-16 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
          <div class="h-5 bg-gray-200 rounded w-20 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
        </div>

        {/* ä»·æ ¼ + å›¾æ ‡éª¨æ¶ */}
        <div class="flex items-center justify-between">
          <div class="h-6 bg-gray-200 rounded w-20 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
          <div class="h-5 w-5 bg-gray-200 rounded-full relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
        </div>

        {/* å°ºå¯¸éª¨æ¶ (å¯é€‰) */}
        <div class="mt-3 pt-3 border-t border-gray-100">
          <div class="h-3 bg-gray-200 rounded w-24 relative overflow-hidden">
            <div class="shimmer absolute inset-0"></div>
          </div>
        </div>
      </div>
    </div>
  ))}

  {/* å±å¹•é˜…è¯»å™¨æç¤º */}
  <span class="sr-only">Loading products, please wait...</span>
</div>

<style>
  /* è„‰å†²åŠ¨ç”» */
  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.7;
    }
  }

  /* é—ªå…‰æ‰«ææ•ˆæœ */
  .shimmer {
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.4) 50%,
      transparent 100%
    );
    animation: shimmer 2s infinite;
  }

  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(100%);
    }
  }

  /* å±å¹•é˜…è¯»å™¨ä¸“ç”¨ */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  /* éª¨æ¶å±å¡ç‰‡æ ·å¼ */
  .product-card-skeleton {
    background: white;
    border: 1px solid #f3f4f6;
    border-radius: 0.5rem;
    overflow: hidden;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  }
</style>
