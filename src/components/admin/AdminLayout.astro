---
/**
 * Admin Layout Component
 * Provides sidebar navigation for admin pages.
 * Auth check must be done in page frontmatter before rendering this component.
 */
import BaseLayout from "@/components/layout/BaseLayout.astro";
import { siteSettings } from "@/config/site-settings";

interface Props {
    title: string;
    currentPage?: "dashboard" | "orders" | "coupons" | "reviews";
    userEmail?: string;
}

const { title, currentPage = "dashboard", userEmail } = Astro.props;

// Navigation items
const navItems = [
    { id: "dashboard", label: "Dashboard", href: "/admin/", icon: "grid" },
    { id: "orders", label: "Orders", href: "/admin/orders/", icon: "package" },
    { id: "coupons", label: "Coupons", href: "/admin/coupons/", icon: "tag" },
    { id: "reviews", label: "Reviews", href: "/admin/reviews/", icon: "star" },
];

const meta = {
    title: `${title} | Admin | ${siteSettings.siteName}`,
    description: "Admin dashboard",
    noindex: true,
};
---

<BaseLayout {meta} hideHeader hideFooter hideWhatsApp>
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="admin-sidebar-header">
                <a href="/admin/" class="admin-logo">
                    <span class="admin-logo-icon">⚙️</span>
                    <span class="admin-logo-text">Admin</span>
                </a>
            </div>

            <nav class="admin-nav">
                {
                    navItems.map((item) => (
                        <a
                            href={item.href}
                            class={`admin-nav-item ${currentPage === item.id ? "active" : ""}`}
                        >
                            {item.icon === "grid" && (
                                <svg
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    class="admin-nav-icon"
                                >
                                    <rect x="3" y="3" width="7" height="7" />
                                    <rect x="14" y="3" width="7" height="7" />
                                    <rect x="14" y="14" width="7" height="7" />
                                    <rect x="3" y="14" width="7" height="7" />
                                </svg>
                            )}
                            {item.icon === "package" && (
                                <svg
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    class="admin-nav-icon"
                                >
                                    <path d="M16.5 9.4l-9-5.19M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                                    <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
                                    <line x1="12" y1="22.08" x2="12" y2="12" />
                                </svg>
                            )}
                            {item.icon === "tag" && (
                                <svg
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    class="admin-nav-icon"
                                >
                                    <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" />
                                    <line x1="7" y1="7" x2="7.01" y2="7" />
                                </svg>
                            )}
                            {item.icon === "star" && (
                                <svg
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    class="admin-nav-icon"
                                >
                                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                                </svg>
                            )}
                            <span>{item.label}</span>
                        </a>
                    ))
                }
            </nav>

            <div class="admin-sidebar-footer">
                <a href="/" class="admin-back-link">
                    <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        class="admin-nav-icon"
                    >
                        <path d="M19 12H5M12 19l-7-7 7-7"></path>
                    </svg>
                    <span>Back to Site</span>
                </a>
                <div class="admin-user-info">
                    <span class="admin-user-email">{userEmail}</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <h1 class="admin-page-title">{title}</h1>
            </header>
            <div class="admin-content">
                <slot />
            </div>
        </main>
    </div>
</BaseLayout>

<style>
    .admin-layout {
        display: flex;
        min-height: 100vh;
        background: #f8fafc;
    }

    /* Sidebar */
    .admin-sidebar {
        width: 240px;
        background: #1e293b;
        color: #e2e8f0;
        display: flex;
        flex-direction: column;
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        z-index: 50;
    }

    .admin-sidebar-header {
        padding: 1.25rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        text-decoration: none;
        color: inherit;
    }

    .admin-logo-icon {
        font-size: 1.5rem;
    }

    .admin-logo-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: #fff;
    }

    /* Navigation */
    .admin-nav {
        flex: 1;
        padding: 1rem 0.75rem;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }

    .admin-nav-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 1rem;
        border-radius: 0.5rem;
        color: #94a3b8;
        text-decoration: none;
        transition: all 0.15s;
        font-size: 0.9rem;
    }

    .admin-nav-item:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
    }

    .admin-nav-item.active {
        background: #3b82f6;
        color: #fff;
    }

    .admin-nav-icon {
        width: 1.25rem;
        height: 1.25rem;
        flex-shrink: 0;
    }

    /* Sidebar Footer */
    .admin-sidebar-footer {
        padding: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .admin-back-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: #94a3b8;
        text-decoration: none;
        font-size: 0.85rem;
        transition: color 0.15s;
    }

    .admin-back-link:hover {
        color: #fff;
    }

    .admin-user-info {
        padding-top: 0.5rem;
    }

    .admin-user-email {
        font-size: 0.75rem;
        color: #64748b;
        word-break: break-all;
    }

    /* Main Content */
    .admin-main {
        flex: 1;
        margin-left: 240px;
        display: flex;
        flex-direction: column;
    }

    .admin-header {
        background: #fff;
        padding: 1.25rem 2rem;
        border-bottom: 1px solid #e2e8f0;
        position: sticky;
        top: 0;
        z-index: 40;
    }

    .admin-page-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
    }

    .admin-content {
        flex: 1;
        padding: 2rem;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .admin-sidebar {
            width: 100%;
            position: relative;
            height: auto;
        }

        .admin-main {
            margin-left: 0;
        }

        .admin-layout {
            flex-direction: column;
        }

        .admin-nav {
            flex-direction: row;
            overflow-x: auto;
            padding: 0.5rem;
        }

        .admin-nav-item {
            white-space: nowrap;
            padding: 0.5rem 0.75rem;
        }

        .admin-sidebar-footer {
            display: none;
        }
    }
</style>
